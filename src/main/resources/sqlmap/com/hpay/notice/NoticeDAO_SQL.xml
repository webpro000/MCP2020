<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 
    SQL File Name : NoticeDAO_SQL.xml
    Description : 공지사항 CRUD
    author webpro000
    since 2020. 4. 7.
    version 1.0
    Modification Information
       since          author              description
    ===========    =============    ===========================
    2020. 4. 7.     webpro000          최초 생성
    2020. 4. 22.    webpro000       공지사항 CRUD
-->

<mapper namespace="com.hpay.notice.service.dao.NoticeDAO">
    <select id="selectNoticeList" parameterType="com.hpay.notice.vo.NoticeVO" resultType="com.hpay.notice.vo.NoticeVO" >
        select 
            * 
        from TBL_NOTICE
        <include refid="selectWhereInclude"/>
        order by notice_seq DESC
    </select>

    <select id="selectNoticeCount" parameterType="com.hpay.notice.vo.NoticeVO" resultType="int" >
        select 
            count(*)
        from TBL_NOTICE
        <include refid="selectWhereInclude"/>
    </select>
    
    <sql id="selectWhereInclude">
        WHERE notice_seq>0
        <if test="notice_seq != null and notice_seq != ''">
        AND notice_seq = #{notice_seq}
        </if>
        <if test="title != null and title != ''">
        AND title LIKE CONCAT('%',#{title},'%')
        </if>
        <if test="contents != null and contents != ''">
        AND contents LIKE CONCAT('%',#{contents},'%')
        </if>
        <if test="gtype != null and gtype != ''">
        AND gtype = #{gtype}
        </if>
        <if test="useyn != null and useyn != ''">
        AND useyn = #{useyn}
        </if>
    </sql>
    
    
    <insert id="insertNotice" parameterType="com.hpay.notice.vo.NoticeVO" >
    <![CDATA[
        insert into TBL_NOTICE(title, contents, gtype, regid, regdt, useyn)
        values(#{title},#{contents},#{gtype},#{regid},now(),#{useyn})
    ]]>  
    </insert>
    <update id="updateNotice" parameterType="com.hpay.notice.vo.NoticeVO" >
        update TBL_NOTICE 
        set uptdt = now()
        <if test="title != null">
        , title = #{title}
        </if>
        <if test="contents != null">
        , contents = #{contents}
        </if>
        <if test="gtype != null">
        , gtype = #{gtype}
        </if>
        <if test="regid != null">
        , regid = #{regid}
        </if>
        <if test="useyn != null">
        , useyn = #{useyn}
        </if>
        where notice_seq = #{notice_seq}

    </update>
    
    <update id="deleteNotice" parameterType="com.hpay.notice.vo.NoticeVO" >
    <![CDATA[
        update TBL_NOTICE 
        set useyn = #{useyn}
        where notice_seq = #{notice_seq}
      ]]>  
    </update>
    
</mapper>
